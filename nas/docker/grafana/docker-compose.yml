services:
  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    restart: unless-stopped
    network_mode: host
    volumes:
      - /share/CACHEDEV1_DATA/docker/grafana/data:/var/lib/grafana
      - /share/CACHEDEV1_DATA/docker/grafana/provisioning:/etc/grafana/provisioning:ro
    environment:
      - GF_SERVER_HTTP_PORT=3030
      - GF_SERVER_ROOT_URL=https://grafana.${DOMAIN}/
      - GF_SECURITY_ADMIN_PASSWORD=${GF_SECURITY_ADMIN_PASSWORD}
      - GF_SECURITY_ALLOW_EMBEDDING=true
      - GF_AUTH_ANONYMOUS_ENABLED=true
      - GF_AUTH_ANONYMOUS_ORG_ROLE=Viewer
      - GF_USERS_ALLOW_SIGN_UP=false
    env_file:
      - .env
    # Notes:
    # - Host networking for access to Prometheus/Loki on localhost
    # - Port 3030 (avoid conflict with Homepage on 3000)
    # - Datasources auto-provisioned from provisioning/datasources/
    # - Admin password set via .env file
    # - Web UI at https://grafana.DOMAIN or http://<NAS_IP>:3030 (direct)
